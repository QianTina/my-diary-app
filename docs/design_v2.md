
# 📝 智能日记 (Smart Diary) 项目设计文档

## 1. 项目概述

本项目旨在打造一个超越纯文本记录的“情感空间”。通过 **AI 情感分析**、**数据可视化**和**隐私加密**技术，帮助用户捕捉生活点滴，洞察个人情绪成长，并提供沉浸式的写作体验。

## 2. 功能规划

### 2.1 核心功能 (MVP)

* **日记管理**：支持 Markdown 渲染、草稿自动保存、实时搜索。
* **多模态记录**：支持文字、多张图片上传、心情图标选择。
* **数据持久化**：LocalStorage 本地存储 + Supabase 云端同步双重保障。

### 2.2 进阶功能 (v2.0 - 智能化与可视化)

* **AI 智能助手**：
* **自动摘要**：根据正文生成简洁标题。
* **情绪感知**：自动分析文字情感并推荐匹配的心情标签。
* **每日引导 (Prompt)**：针对“写作障碍”提供每日启发性问题。


* **情感洞察**：
* **心情月历**：通过颜色深浅反映当月情绪起伏。
* **关键词云**：基于分词技术展现近期的关注焦点。


* **环境自动感知**：自动获取当前地理位置及天气信息（阴晴雨雪）。

### 2.3 专业功能 (v3.0 - 安全与体验)

* **端到端加密 (E2EE)**：用户自定义密钥，云端仅存储加密后的密文，确保极致隐私。
* **沉浸式模式 (Zen Mode)**：全屏写作界面，集成白噪音（雨声、白噪音等）。
* **数据生态**：支持 JSON/Markdown 批量导出，支持 PWA（可安装至桌面和手机）。

---

## 3. 技术架构方案

### 3.1 核心栈

| 组件 | 技术选型 | 理由 |
| --- | --- | --- |
| **框架** | React 18 + TS | 组件化开发，类型安全，方便后期转 Taro 小程序。 |
| **构建** | Vite 5 | 极致的热更新速度，提升开发幸福感。 |
| **状态** | Zustand | 比 Redux 轻量，比 Context 性能高，适合管理日记流。 |
| **样式** | Tailwind CSS | 快速实现响应式和主题切换（暗黑模式）。 |
| **数据库** | Supabase | 后端即服务 (BaaS)，自带 Auth 和实时数据库。 |

### 3.2 关键技术点实现

* **状态管理设计**：使用 Zustand 的 `persist` 中间件，自动将状态同步到磁盘，防止刷新丢失。
* **解耦设计**：封装统一的 `StorageService` 接口，切换 LocalStorage 和 Supabase 仅需修改配置。

---

## 4. 数据结构设计 (扩展版)

```typescript
interface DiaryEntry {
  id: string; // UUID v4
  title: string; // 标题
  content: string; // Markdown正文
  mood: 'happy' | 'sad' | 'neutral' | 'calm' | 'angry'; // 心情标签
  weather: {
    temp: number;
    description: string; // 如：多云
  };
  location: string; // 如：上海 · 静安
  tags: string[]; // 标签数组
  images: string[]; // 图片URL数组
  is_encrypted: boolean; // 是否加密存储
  created_at: string; // ISO 8601 格式
  updated_at: string;
}

```

---

## 5. UI/UX 视觉体系

* **卡片式布局**：模仿 Pinterest 的瀑布流，突出图片和文字片段。
* **色彩心理学**：根据用户选择的心情，动态调整页面的强调色（如：平静-蓝色，开心-橙色）。
* **微交互**：使用 `framer-motion` 实现列表载入和页面切换的丝滑动画。

---

## 6. 核心流程图

### 6.1 数据流转逻辑

1. **用户输入** -> 2. **Zustand 实时状态更新** -> 3. **触发本地缓存 (Debounce)** -> 4. **AI 情感分析 (Optional)** -> 5. **同步至 Supabase**。

---

## 7. 开发路线图 (Roadmap)

### 第一阶段：地基搭建 (Done/In Progress)

* [x] React + Vite + TS 项目初始化。
* [x] 封装 Zustand 基础 Store。
* [x] 实现基础 CRUD 和 Markdown 编辑预览。

### 第二阶段：体验增强 (Next Steps)

* [ ] **集成天气 API**：在新建日记时自动获取环境信息。
* [ ] **实现心情追踪可视化**：引入 `recharts` 绘制心情曲线。
* [ ] **增加暗黑模式**：适配深夜写作场景。

### 第三阶段：智能与安全

* [ ] **接入 OpenAI/DeepSeek API**：实现自动标题生成。
* [ ] **实现 Web Crypto API**：为敏感日记提供本地加解密。
* [ ] **PWA 支持**：配置 Service Worker 实现离线访问。

---

## 8. 项目亮点 (适合写在简历上)

1. **架构灵活性**：通过策略模式实现了 LocalStorage 与云端数据库的无缝切换。
2. **性能优化**：通过分词算法和缓存机制，在前端实现了秒级的关键词检索。
3. **用户隐私**：设计并实现了基于 Web Crypto API 的端到端加密方案，保障用户数据安全。
4. **跨平台潜力**：逻辑层与视图层完全分离，业务逻辑可 90% 复用至 Taro 小程序。
